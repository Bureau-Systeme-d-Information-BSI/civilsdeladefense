- user = @job_application.user
- archived = @job_application.job_offer.archived?
- core_object = archived ? @job_application.personal_profile : user
%div{id: dom_id(@job_application, 'profile')}
  - if archived
    %em Profile archivé
  .card
    .card-header.bg-white.font-weight-bold.text-secondary
      = fa_icon('file-document', class: 'text-secondary')
      Données personnelles
    .card-body.bg-white
      - fields = personal_profile_fields1
      - fields.each do |field|
        - hsh = {obj: core_object, field: field, disabled: archived}
        - hsh[:choices] = choices_gender if field == :gender
        = render partial: 'job_application_profile_field', locals: hsh
  .card
    .card-header.bg-white.font-weight-bold.text-secondary
      = fa_icon('file-document', class: 'text-secondary')
      Données professionnelles
    .card-body.bg-white
      - fields = personal_profile_fields2
      - fields.each do |field|
        - hsh = {obj: core_object, disabled: archived}
        - hsh[:field] = field unless field =~ /_level/
        - hsh[:association] = field if field =~ /_level/
        - hsh[:choices] = choices_boolean if field == :is_currently_employed
        - hsh[:choices] = choices_month if field == :availability_date_in_month
        = render partial: 'job_application_profile_field', locals: hsh
  .card
    .card-header.bg-white.font-weight-bold.text-secondary
      = fa_icon('file-document', class: 'text-secondary')
      Spécificités vis-à-vis de l'offre sélectionnée
    .card-body.bg-white
      - fields = personal_profile_fields3
      - fields.each do |field|
        - hsh = {obj: @job_application, field: field, disabled: archived}
        = render partial: 'job_application_profile_field', locals: hsh
