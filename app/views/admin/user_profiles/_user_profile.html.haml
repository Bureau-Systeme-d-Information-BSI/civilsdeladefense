- archived = defined?(@job_application) ? @job_application.job_offer.archived? : nil
- user_profile = archived ? @job_application.user_profile : (user.user_profile || user.build_user_profile)
%div{id: dom_id(user, 'profile')}
  - if archived
    %em Profile archivé
  .card
    .card-header.bg-white.font-weight-bold.text-secondary
      = fa_icon('file-document', class: 'text-secondary')
      Données personnelles
    .card-body.bg-white
      - fields = user_profile_fields1
      - fields.each do |field|
        - hsh = {user: user, user_profile: user_profile, field: field, disabled: archived}
        - hsh[:choices] = choices_gender if field == :gender
        = render partial: '/admin/user_profiles/user_profile_field', locals: hsh
  .card
    .card-header.bg-white.font-weight-bold.text-secondary
      = fa_icon('file-document', class: 'text-secondary')
      Données professionnelles
    .card-body.bg-white
      - fields = user_profile_fields2
      - fields.each do |field|
        - hsh = {user: user, user_profile: user_profile, disabled: archived}
        - hsh[:field] = field unless field =~ /_level|range/
        - hsh[:association] = field if field =~ /_level|range/
        - hsh[:choices] = choices_boolean if field == :is_currently_employed
        = render partial: '/admin/user_profiles/user_profile_field', locals: hsh
