- cache current_organization do
  - ary = current_organization.pages.root&.descendants || []
  - links, pages = ary.partition(&:only_link?)
  %footer#footer.rf-footer{:role => "contentinfo"}
    - social_urls = %i[linkedin_url twitter_url youtube_url instagram_url facebook_url]
    - if social_urls.any?{|x| current_organization.send(x).present? }
      .rf-footer__top
        .rf-container
          .rf-grid-row.rf-grid-row--start.rf-grid-row--gutters
            .rf-col-12
              .rf-footer__top-cat
                Les réseaux sociaux #{current_organization.possessive_article} #{strip_tags(current_organization.brand_name)}
              %ul.rf-footer__top-list
                %li
                  .d-flex.flex-row
                    - social_urls.each do |social_url|
                      - if current_organization.send(social_url).present?
                        = link_to current_organization.send(social_url), class: 'rf-footer__top-link rf-mr-2w' do
                          - icon_name = social_url.to_s.gsub('_url', '')
                          - icon_name += {'facebook' => '-circle', 'linkedin' => '-box'}[icon_name] || ''
                          - icon_name += '-fill'
                          = fa_icon icon_name, class: 'rf-icon-xl'
    .rf-container
      .rf-footer__body
        .rf-footer__brand
          = link_to root_path, title: strip_tags(current_organization.brand_name), class: 'rf-logo' do
            %span.rf-logo__title
              = simple_format(current_organization.brand_name, nil, wrapper_tag: 'span')
          - if current_organization.operator_logo.present?
            = link_to current_organization.operator_url, class: 'rf-footer__brand-link' do
              = image_tag(current_organization.operator_logo.url, alt: current_organization.service_name, style: 'width:auto; height:5rem;')
        .rf-footer__content
          - if (desc = current_organization.service_description).present?
            %p.rf-footer__content-desc= current_organization.service_description
          %ul.rf-footer__content-list
            - links.each do |page|
              %li
                = link_to page.title, page.url, class: 'rf-footer__content-link'
      - if current_organization.partner_1_logo.present? || current_organization.partner_2_logo.present? || current_organization.partner_3_logo.present?
        .rf-footer__partners
          -# %h4.rf-footer__partners-title Nos partenaires
          .rf-footer__partners-logos
            .rf-footer__partners-main.rf-mt-0
              - if current_organization.partner_1_logo.present?
                = link_to current_organization.partner_1_url, class: 'footer__partners-link' do
                  = image_tag(current_organization.partner_1_logo.url, alt: current_organization.partner_1_name, class: 'rf-footer__logo', style: 'width:auto; height:5rem;')
            .rf-footer__partners-sub.rf-mt-0
              - if current_organization.partner_2_logo.present?
                = link_to current_organization.partner_2_url, class: 'footer__partners-link' do
                  = image_tag(current_organization.partner_2_logo.url, alt: current_organization.partner_2_name, class: 'rf-footer__logo', style: 'width:auto; height:5rem;')
              - if current_organization.partner_3_logo.present?
                = link_to current_organization.partner_3_url, class: 'footer__partners-link' do
                  = image_tag(current_organization.partner_3_logo.url, alt: current_organization.partner_3_name, class: 'rf-footer__logo', style: 'width:auto; height:5rem;')
      .rf-footer__bottom
        %ul.rf-footer__bottom-list
          %li.rf-footer__bottom-item
            = link_to "Accessibilité : non", "#", class: 'rf-footer__bottom-link'
          - pages.each do |page|
            %li.rf-footer__bottom-item
              = link_to page.title, page_path(page), class: 'rf-footer__bottom-link'
        .rf-footer__bottom-copy
          © #{strip_tags(current_organization.brand_name)} #{Time.now.year}
